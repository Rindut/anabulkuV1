import{j as v,h,r as g,i as w,s as u,t as b}from"./index-B2bpzhXi.js";const E=({petType:i,size:c="md",gender:s="Male",className:d,floating:n=!1})=>{const f={sm:"h-20 w-20",md:"h-32 w-32",lg:"h-40 w-40",xl:"h-48 w-48"},l=i.toLowerCase();console.log("Pet3DAvatar rendered with:",{petType:i,normalizedPetType:l,gender:s});let o=null;l==="cat"?s==="Female"?o="/lovable-uploads/f30f5de4-ad57-4373-9e61-ae7bc0bb6b7e.png":o="/lovable-uploads/a38b8e7b-a267-4de5-bca5-4e8d3a67a542.png":s==="Female"?o="/lovable-uploads/8ff221f5-6b20-42db-8af6-3efa83db08e4.png":o="/lovable-uploads/6db4f94e-6f10-4087-bc7b-fc4184ee3857.png";const p=l==="cat"?s==="Female"?"/lovable-uploads/f30f5de4-ad57-4373-9e61-ae7bc0bb6b7e.png":"/lovable-uploads/a38b8e7b-a267-4de5-bca5-4e8d3a67a542.png":s==="Female"?"/lovable-uploads/8ff221f5-6b20-42db-8af6-3efa83db08e4.png":"/lovable-uploads/6db4f94e-6f10-4087-bc7b-fc4184ee3857.png";return v.jsxs("div",{className:h(f[c],"flex items-end justify-center relative",n&&"relative z-10",d),children:[v.jsx("img",{src:o,alt:`${l} avatar`,className:h("w-full object-cover object-bottom",n&&"absolute bottom-0 h-[160%] drop-shadow-[0_4px_12px_rgba(0,0,0,0.25)] z-10",!n&&"h-[150%]"),style:{objectPosition:"bottom",transform:n?"translateY(-30px)":void 0},loading:"lazy",onError:a=>{const e=a.currentTarget;e.onerror=null,e.src=p,e.onerror=t=>{if(t instanceof Event&&t.currentTarget instanceof HTMLImageElement){const r=t.currentTarget;r.onerror=null,r.nextSibling.textContent="Avatar not available",r.style.display="none"}}}}),v.jsx("span",{className:"hidden text-sm text-gray-500 text-center"})]})};function P(){const[i,c]=g.useState([]),[s,d]=g.useState(!0),{user:n}=w();g.useEffect(()=>{n&&f()},[n]);async function f(){try{d(!0);const{data:a,error:e}=await u.from("pets").select("*").order("created_at",{ascending:!1});if(e)throw e;a&&c(a)}catch(a){b({title:"Error fetching pets",description:a.message,variant:"destructive"})}finally{d(!1)}}async function l(a){try{const{data:e,error:t}=await u.from("pets").insert(a).select();if(t)throw t;return e?(c(r=>[e[0],...r]),e[0]):null}catch(e){return b({title:"Error adding pet",description:e.message,variant:"destructive"}),null}}async function o(a,e){try{const{data:t,error:r}=await u.from("pets").update(e).eq("id",a).select();if(r)throw r;return t?(c(x=>x.map(m=>m.id===a?{...m,...t[0]}:m)),t[0]):null}catch(t){return b({title:"Error updating pet",description:t.message,variant:"destructive"}),null}}async function p(a){try{const{data:e,error:t}=await u.from("pets").select("*").eq("id",a).single();if(t)throw t;return e}catch(e){return b({title:"Error fetching pet",description:e.message,variant:"destructive"}),null}}return{pets:i,loading:s,fetchPets:f,addPet:l,updatePet:o,getPet:p}}export{E as P,P as u};
